{
  "references": {
    "roles": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "national_admin",
          "district_admin",
          "analytics",
          "gateway"
        ]
      }
    }
  },
  "type": "object",
  "properties": {
    "locales": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "disabled": {
            "type": "boolean"
          }
        }
      }
    },
    "locale": {
      "type": "string"
    },
    "locale_outgoing": {
      "type": "string"
    },
    "date_format": {
      "type": "string"
    },
    "reported_date_format": {
      "type": "string"
    },
    "forms_only_mode": {
      "type": "boolean"
    },
    "default_responses": {
      "type": "object",
      "properties": {
        "start_date": {
          "type": "string"
        }
      }
    },
    "district_admins_access_unallocated_messages": {
      "type": "boolean"
    },
    "public_access": {
      "type": "boolean"
    },
    "default_country_code": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "type": "number"
        }
      ]
    },
    "gateway_number": {
      "type": "string"
    },
    "schedule_morning_hours": {
      "type": "number",
      "minimum": 0,
      "exclusiveMaximum": 24
    },
    "schedule_morning_minutes": {
      "type": "number",
      "minimum": 0,
      "exclusiveMaximum": 60
    },
    "schedule_evening_hours": {
      "type": "number",
      "minimum": 0,
      "exclusiveMaximum": 24
    },
    "schedule_evening_minutes": {
      "type": "number",
      "minimum": 0,
      "exclusiveMaximum": 60
    },
    "permissions": {
      "type": "object",
      "properties": {
        "can_export_messages": {
          "$ref": "#/references/roles"
        },
        "can_export_forms": {
          "$ref": "#/references/roles"
        },
        "can_export_contacts": {
          "$ref": "#/references/roles"
        },
        "can_export_feedback": {
          "$ref": "#/references/roles"
        },
        "can_view_analytics": {
          "$ref": "#/references/roles"
        },
        "can_view_data_records": {
          "$ref": "#/references/roles"
        },
        "can_view_unallocated_data_records": {
          "$ref": "#/references/roles"
        },
        "can_view_users": {
          "$ref": "#/references/roles"
        },
        "can_edit": {
          "$ref": "#/references/roles"
        },
        "can_log_out_on_android": {
          "$ref": "#/references/roles"
        },
        "can_update_messages": {
          "$ref": "#/references/roles"
        },
        "can_update_users": {
          "$ref": "#/references/roles"
        },
        "can_update_people": {
          "$ref": "#/references/roles"
        },
        "can_update_places": {
          "$ref": "#/references/roles"
        },
        "can_create_records": {
          "$ref": "#/references/roles"
        },
        "can_access_gateway_api": {
          "$ref": "#/references/roles"
        },
        "can_create_users": {
          "$ref": "#/references/roles"
        },
        "can_create_people": {
          "$ref": "#/references/roles"
        },
        "can_create_places": {
          "$ref": "#/references/roles"
        },
        "can_view_tasks": {
          "$ref": "#/references/roles"
        },
        "can_view_tasks_tab": {
          "$ref": "#/references/roles"
        },
        "can_configure": {
          "$ref": "#/references/roles"
        },
        "can_view_messages": {
          "$ref": "#/references/roles"
        },
        "can_view_messages_tab": {
          "$ref": "#/references/roles"
        },
        "can_view_reports": {
          "$ref": "#/references/roles"
        },
        "can_view_reports_tab": {
          "$ref": "#/references/roles"
        },
        "can_view_analytics_tab": {
          "$ref": "#/references/roles"
        },
        "can_view_contacts": {
          "$ref": "#/references/roles"
        },
        "can_view_contacts_tab": {
          "$ref": "#/references/roles"
        },
        "can_edit_profile": {
          "$ref": "#/references/roles"
        },
        "can_delete_reports": {
          "$ref": "#/references/roles"
        },
        "can_bulk_delete_reports": {
          "$ref": "#/references/roles"
        },
        "can_update_reports": {
          "$ref": "#/references/roles"
        },
        "can_delete_contacts": {
          "$ref": "#/references/roles"
        },
        "can_delete_messages": {
          "$ref": "#/references/roles"
        },
        "can_delete_users": {
          "$ref": "#/references/roles"
        }
      }
    },
    "roles": {
      "type": "object",
      "propertyNames": {
        "pattern": "^[A-Za-z][A-Za-z0-9_-]*$"
      },
      "patternProperties": {
        "^[A-Za-z][A-Za-z0-9_-]*$": {
          "type": "object",
          "Properties": {
            "name": {
              "type": "string"
            },
            "offline": {
              "type": "boolean"
            }
          }
        }
      }
    },
    "replications": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "fromSuffix": {
            "type": "string"
          },
          "toSuffix": {
            "type": "string"
          },
          "text_expression": {
            "type": "string"
          },
          "cron": {
            "type": "string"
          }
        }
      }
    },
    "replication_depth": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "role": {
            "type": "string"
          },
          "depth": {
            "type": "integer"
          }
        }
      }
    },
    "changes_controller": {
      "type": "object",
      "properties": {
        "reiterate_changes": {
          "type": "boolean"
        },
        "changes_limit": {
          "type": "integer"
        },
        "debounce_interval": {
          "type": "integer"
        }
      }
    },
    "muting": {
      "type": "object",
      "properties": {
        "mute_forms": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "unmute_forms": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "validations": {
          "type": "object",
          "properties": {
            "join_responses": {
              "type": "boolean"
            },
            "list": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "property": {
                    "type": "string"
                  },
                  "rule": {
                    "type": "string"
                  },
                  "translation_key": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "messages": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "translation_key": {
                "type": "string"
              },
              "event_type": {
                "type": "string",
                "enum": [
                  "mute",
                  "unmute",
                  "already_muted",
                  "already_unmuted",
                  "contact_not_found"
                ]
              },
              "recipient": {
                "type": "string",
                "enum": [
                  "reporting_unit",
                  "parent",
                  "clinic",
                  "chw_phone"
                ]
              },
              "bool_expr": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "purging": {
      "type": "object",
      "properties": {
        "fn": {
          "type": "string"
        }
      }
    },
    "registrations": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "form": {
            "type": "string"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "trigger": {
                  "type": "string",
                  "enum": [
                    "add_birth_date",
                    "add_patient",
                    "assign_schedule",
                    "clear_schedule",
                    "add_expected_date"
                  ]
                },
                "params": {
                  "oneOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "object"
                    },
                    {
                      "type": "array"
                    }
                  ]
                },
                "bool_expr": {
                  "type": "string"
                }
              }
            }
          },
          "validations": {
            "type": "object",
            "properties": {
              "join_responses": {
                "type": "boolean"
              },
              "list": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "property": {
                      "type": "string"
                    },
                    "rule": {
                      "type": "string"
                    },
                    "translation_key": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "messages": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "translation_key": {
                  "type": "string"
                },
                "event_type": {
                  "type": "string",
                  "enum": [
                    "report_accepted",
                    "registration_not_found"
                  ]
                },
                "recipient": {
                  "type": "string",
                  "enum": [
                    "reporting_unit",
                    "parent",
                    "clinic",
                    "chw_phone"
                  ]
                },
                "bool_expr": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "patient_reports": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "form": {
            "type": "string"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "trigger": {
                  "type": "string",
                  "enum": [
                    "add_birth_date",
                    "add_patient",
                    "assign_schedule",
                    "clear_schedule",
                    "add_expected_date"
                  ]
                },
                "params": {
                  "type": "string"
                },
                "bool_expr": {
                  "type": "string"
                }
              }
            }
          },
          "validations": {
            "type": "object",
            "properties": {
              "join_responses": {
                "type": "boolean"
              },
              "list": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "property": {
                      "type": "string"
                    },
                    "rule": {
                      "type": "string"
                    },
                    "translation_key": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "messages": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "translation_key": {
                  "type": "string"
                },
                "event_type": {
                  "type": "string",
                  "enum": [
                    "report_accepted",
                    "registration_not_found"
                  ]
                },
                "recipient": {
                  "type": "string",
                  "enum": [
                    "reporting_unit",
                    "parent",
                    "clinic",
                    "chw_phone"
                  ]
                },
                "bool_expr": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "schedules": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "translation_key": {
            "type": "string"
          },
          "summary": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "start_from": {
            "type": "string"
          },
          "messages": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "translation_key": {
                  "type": "string"
                },
                "group": {
                  "type": "number"
                },
                "offset": {
                  "type": "string"
                },
                "send_day": {
                  "type": "string"
                },
                "send_time": {
                  "type": "string"
                },
                "recipient": {
                  "type": "string",
                  "enum": [
                    "reporting_unit",
                    "parent",
                    "clinic",
                    "chw_phone"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "notifications": {
      "type": "object",
      "properties": {
        "off_form": {
          "type": "string"
        },
        "on_form": {
          "type": "string"
        },
        "confirm_deactivation": {
          "type": "boolean"
        },
        "validations": {
          "type": "object",
          "properties": {
            "join_responses": {
              "type": "boolean"
            },
            "list": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "property": {
                    "type": "string"
                  },
                  "rule": {
                    "type": "string"
                  },
                  "translation_key": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "messages": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "translation_key": {
                "type": "string"
              },
              "event_type": {
                "type": "string",
                "enum": [
                  "on_mute",
                  "on_unmute",
                  "patient_not_found"
                ]
              },
              "recipient": {
                "type": "string",
                "enum": [
                  "reporting_unit",
                  "parent",
                  "clinic",
                  "chw_phone"
                ]
              },
              "bool_expr": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "transitions": {
      "type": "object",
      "properties": {
        "default_responses": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "update_clinics": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "accept_patient_reports": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "conditional_alerts": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "update_sent_by": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "registration": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "update_notifications": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "update_scheduled_reports": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "multi_report_alerts": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "update_sent_forms": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "generate_patient_id_on_people": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        },
        "death_reporting": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "object",
              "properties": {
                "load": {
                  "type": "string"
                }
              }
            }
          ]
        }
      }
    },
    "death_reporting": {
      "type": "object",
      "properties": {
        "mark_deceased_forms": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "date_field": {
          "type": "string"
        }
      }
    },
    "forms": {
      "type": "object",
      "propertyNames": {
        "pattern": "^[A-Za-z][A-Za-z0-9_-]*$"
      },
      "patternProperties": {
        "^[A-Za-z][A-Za-z0-9_-]*$": {
          "type": "object",
          "properties": {
            "meta": {
              "type": "object",
              "properties": {
                "code": {
                  "type": "string"
                },
                "icon": {
                  "type": "string"
                },
                "translation_key": {
                  "type": "string"
                }
              }
            },
            "fields": {
              "type": "object",
              "propertyNames": {
                "pattern": "^[A-Za-z][A-Za-z0-9_]*$"
              },
              "patternProperties": {
                "^[A-Za-z][A-Za-z0-9_]*$": {
                  "type": "object",
                  "properties": {
                    "labels": {
                      "type": "object",
                      "properties": {
                        "short": {
                          "type": "object",
                          "properties": {
                            "translation_key": {
                              "type": "string"
                            }
                          }
                        },
                        "tiny": {
                          "type": "object",
                          "propertyNames": {
                            "pattern": "^[a-z]{2}$"
                          },
                          "patternProperties": {
                            "^[a-z]{2}$": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "position": {
                      "type": "number"
                    },
                    "flags": {
                      "type": "object",
                      "properties": {
                        "input_digits_only": {
                          "type": "boolean"
                        }
                      }
                    },
                    "length": {
                      "type": "array",
                      "minItems": 1,
                      "maxItems": 2
                    },
                    "type": {
                      "type": "string",
                      "enum": [
                        "string",
                        "integer",
                        "boolean",
                        "date",
                        "complex"
                      ]
                    },
                    "required": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "tasks": {
      "type": "object",
      "properties": {
        "rules": {
          "type": "string"
        },
        "targets": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "count",
                      "percent"
                    ]
                  },
                  "goal": {
                    "oneOf": [
                      {
                        "type": "number",
                        "enum": [
                          -1
                        ]
                      },
                      {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 100
                      }
                    ]
                  },
                  "translation_key": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "context": {
                    "type": "string"
                  },
                  "subtitle_translation_key": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "outgoing_deny_list": {
      "type": "string"
    },
    "outgoing_deny_with_alphas": {
      "type": "boolean"
    },
    "outgoing_deny_shorter_than": {
      "type": "number"
    },
    "multipart_sms_limit": {
      "type": "number"
    },
    "contact_summary": {
      "type": "string"
    },
    "multi_report_alerts": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "is_report_counted": {
            "type": "string"
          },
          "num_reports_threshold": {
            "type": "number"
          },
          "message": {
            "type": "string"
          },
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "time_window_in_days": {
            "type": "number"
          },
          "forms": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "outbound": {
      "type": "object",
      "propertyNames": {
        "pattern": "^[A-Za-z][A-Za-z0-9_-]*$"
      },
      "patternProperties": {
        "^[A-Za-z][A-Za-z0-9_-]*$": {
          "type": "object",
          "relevant_to": {
            "type": "string"
          },
          "destination": {
            "type": "object",
            "properties": {
              "base_url": {
                "type": "string",
                "format": "uri"
              },
              "auth": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "usename": {
                    "type": "string"
                  },
                  "password-key": {
                    "type": "string"
                  },
                  "path": {
                    "type": "string"
                  }
                }
              },
              "path": {
                "type": "string"
              }
            }
          },
          "mapping": {
            "type": "object",
            "propertyNames": {
              "pattern": "^[A-Za-z][A-Za-z0-9_.-]*$"
            },
            "patternProperties": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "object",
                  "properties": {
                    "expr": {
                      "type": "string"
                    },
                    "optional": {
                      "type": "boolean"
                    }
                  }
                },
                {
                  "type": "object",
                  "properties": {
                    "path": {
                      "type": "string"
                    },
                    "optional": {
                      "type": "boolean"
                    }
                  }
                }
              ]
            }
          }
        }
      }
    },
    "sms": {
      "type": "object",
      "properties": {
        "outgoing_service": {
          "type": "string"
        }
      }
    },
    "uhc": {
      "type": "object",
      "properties": {
        "contacts_default_sort": {
          "type": "string"
        },
        "visit_count": {
          "type": "object",
          "properties": {
            "month_start_date": {
              "type": "integer",
              "minimum": 1,
              "maximum": 31
            },
            "visit_count_goal": {
              "type": "integer"
            }
          }
        }
      }
    },
    "translations": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "key": {
            "type": "string"
          },
          "default": {
            "type": "string"
          },
          "translations": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "locale": {
                  "type": "string"
                },
                "content": {
                  "type": "string"
                },
                "default": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  }
}
